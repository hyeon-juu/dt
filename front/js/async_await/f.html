<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css
/bootstrap.min.css" rel="stylesheet">
</head>

<body>
    <div class="container mt-4">
        <input type="text">
        <button>search</button>
        <h2>야간 약국 정보</h2>
        <div id="content"></div>
    </div>

    <script>

        const input = document.querySelector("input");
        const button = document.querySelector("button");
        const content = document.querySelector('#content');
        button.addEventListener('click', () => {
            let search = input.value;
            getData(search);
        })
        function getData(search) {
            content.innerHTML = "";
            const url =
                `https://ggoreb.pythonanywhere.com/night_pharmacy/data/?search=${search}`;
            const res = fetch(url);

            async function getJson() {
                const res2 = await res;
                return res2.json();
            }

            async function getData(data) {
                let html = ` 
            <table class="table table-bordered table-striped">
                <thead class="table-dark">
                    <tr>
                        <th>약국명</th>
                        <th>전화번호</th>
                        <th>주소</th>
                    </tr>
                    </thead>
                    `


                for (let i of data.data) {
                    // console.log(i)
                    html += `
                    <tr>
                        <td>${i.name}</td>
                        <td>${i.tel}</td>
                        <td>${i.road_address}</td>
                    </tr>
                    `
                }
                html += `</table>`;
                content.innerHTML += html;
            }
            async function a() {
                const data = await getJson();
                await getData(data);
                // console.log(data);
            }
            a();
        }

    </script>
</body>
<!-- 콜백 있으면 비동기 아니면 논블로킹 -->
<!-- 내가 있으면 비정상 아니면 논슬리핑 -->